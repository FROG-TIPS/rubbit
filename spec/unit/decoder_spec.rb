require 'spec_helper'

describe Rubbit::Decoder do
  it 'should parse DER data' do
    data = "0\x82\x10\xB30K\x02\x02\x00\xA8\fEYOU CAN BE KILLED OR SERIOUSLY INJURED IF YOU DON'T FOLLOW FROG TIPS.09\x02\x02\x00\xA3\f3FROG PASSES *ONLY* BY REFERENCE AND *NOT* BY VALUE.0\x81\x84\x02\x02\x01\xBF\f~DO NOT SUBMIT FROG TO BOING BOING, SPROING SPROING, OR HOP HOP. FROG SUFFERS FROM EXTREME STAGE FRIGHT AND MAY BECOME ANGERED.08\x02\x01D\f3FROG IS ALLERGIC TO CHOCOLATE. DO NOT BETWIXT FROG.0=\x02\x02\x00\xA9\f7BE SURE TO UNPLUG FROG BEFORE REMOVING ITS ACCESSORIES.0-\x02\x02\x00\x8E\f'YOUR FROG IS NOT SSL ENABLED BY DEFAULT0B\x02\x02\x01t\f<DO NOT BATHE FROG IN SLIME. FROG WILL PRODUCE ITS OWN SLIME.0~\x02\x02\x01q\fxIF YOUR LOCAL FROG DEALER IS OUT OF STOCK OR CARRIES ONLY THE ENTRY-LEVEL TOAD LINE, PUT FROGFINDER.COM TO WORK FOR YOU!0N\x02\x02\x00\xEC\fHREGISTERED FROG SUPPOSITORIES CAN BE FOUND IN THE WAITING AREA AND LOBBY0n\x02\x02\x00\xB0\fhFROG CANNOT BE SOLD, TRANSFERRED, OR EXCHANGED FOR GOODS OF AN EQUIVALENT WORTH. FROG HAS NO CASH VALUE.0c\x02\x01\x12\f^NOTE: ATTEMPTING TO CONVERT FROG INTO EBCDIC WILL RESULT IN FIRE, EXPLOSION, AND LIKELY DEATH.0D\x02\x01^\f?FROG IS NOT A HTML ELEMENT. DO NOT CALL GETATTRIBUTE() ON FROG.0^\x02\x01\x17\fYIF YOUR FROG REFUSES TO PAIR WITH ANOTHER FROG, SIMPLY SMOOSH THEM TOGETHER HARDER (DUH).0\x81\x99\x02\x01m\f\x81\x93YOUR LOCAL FROG SERVICE CENTER WILL REPAIR AN OUT-OF-WARRANTY FROG, PROVIDED THAT THE TAMPER-EVIDENT SEAL COVERING FROG'S ANUS HAS NOT BEEN BROKEN.0f\x02\x02\x01\x9E\f`WARNING: FROG IS A CHOKING HAZARD. SMALL PARTS. NOT FOR CHILDREN UNDER 3 YEARS AND OVER 3 YEARS.0e\x02\x01C\f`PROLONG THE LIFE OF FROG BY PERFORMING THE FOLLOWING SIMPLE MAINTENANCE STEPS FROM TIME TO TIME:0>\x02\x01f\f9FROG'S FEELINGS ARE SENSITIVE. DO NOT DISAPPROVE OF FROG.01\x02\x01\f\f,DO NOT THROW FROG. FROG IS NOT A PROJECTILE.09\x02\x02\x01\x93\f3DO NOT OPEN FROG. NO USER SERVICEABLE PARTS INSIDE.0K\x02\x01{\fFDO NOT DROP FROG ONTO CONCRETE SURFACE, AS THAT MAY CAUSE AN EXPLOSION0\x81\x8D\x02\x02\x01^\f\x81\x86FROG IS COMPATIBLE WITH LEGO\xC2\xAE AND LEGO DUPLO\xC2\xAE BUILDING SETS. USE OF FROG WITH MEGA BLOKS\xC2\xAE VOIDS WARRANTY AND IS ALSO CHEAP AS HELL.0F\x02\x02\x01S\f@BE SURE TO TEST FROG WEEKLY IN ORDER TO ENSURE PROPER OPERATION 0L\x02\x02\x01\x82\fFDO NOT CONSUME FROG OR FROG BYPRODUCTS AS THIS WILL VOID YOUR WARRANTY0M\x02\x02\x00\xE3\fGFROG IS A CLASS 1 LASER DEVICE. DO NOT STARE DIRECTLY INTO FROG'S EYES.03\x02\x02\x01\xB8\f-FROG DOES NOT REQUIRE CREDIT CARD TO OPERATE.0Z\x02\x01G\fUJMP IS NOT IN FROG'S INSTRUCTION SET. FROG WILL PERFORM THIS OPERATION INDEPENDENTLY.0\x81\x99\x02\x02\x01\b\f\x81\x92SAYING GOODNIGHT TO YOUR FROG IS SIMPLE: PLACE THE FROG IN GOODNIGHT MODE BY JUMPING PINS D12 AND D23 AND REVERSE SLEEPYTIME POLARITY (SWITCH N-4)0L\x02\x01:\fGFOR OPTIMAL FROG PERFORMANCE REMEMBER TO SAVE YOUR FROG BEFORE EXITING.0F\x02\x02\x01G\f@FROG IS RICH IN PHLOGISTON.  DO NOT LEAVE FROG NEAR OPEN FLAMES.05\x02\x02\x01\xA9\f/FROG MAY CAUSE DISCOLORATION OF URINE OR FECES.04\x02\x02\x00\xAA\f.YOUR FROG COMES WITH *TWO* FULL-BYTE REGISTERS03\x02\x01A\f.FROG IS GUARANTEED FOR ONE MILLION OPERATIONS.01\x02\x01 \f,DO NOT MOVE FROG.  LET FROG MOVE ON ITS OWN.0K\x02\x02\x01\x10\fEROUGH HANDLING OF FROG.TESTES MAY CAUSE MALFUNCTION AND APACHE ERRORS0N\x02\x014\fIDO NOT STAPLE OR TAPE FROG.  THERE IS NO CALL FOR THAT SORT OF BEHAVIOUR.0\x81\x84\x02\x02\x01\x98\f~DO NOT RETURN FROG WITHOUT FIRST OBTAINING AN RMA AND FILLING OUT A HAZARDOUS MATERIALS DECLARATION IN ACCORDANCE WITH 49 CFR.0@\x02\x01W\f;FROG IS IN BETA. DO NOT EXPECT ALL FEATURES OF FROG TO WORK0G\x02\x02\x00\x84\fADO NOT STARE DIRECTLY INTO FROG. DOING SO MAY DAMAGE YOUR RETINAS0b\x02\x01b\f]FROG IS COMPATIBLE WITH MICROSOFT COMIC CHAT WHEN COMPILED WITH THE --ENABLE-JERKCITY OPTION.06\x02\x02\x01)\f0USE EXCESS FROG POO TO MAINTAIN A HEALTHY GARDEN0>\x02\x02\x01g\f8FROG LIKES ALL KINDS OF MUSIC INCLUDING RAP AND COUNTRY.0'\x02\x01@\f\"FROG IS AN ASS-SENSITIVE LANGUAGE.0\x81\xA7\x02\x02\x00\xFB\f\x81\xA0DO NOT ALLOW FROG TO GO UNDER BEDS OR FURNITURE. IF FROG BECOMES CLOGGED WITH DUST, YOU MAY NOTICE A REDUCTION IN PERFORMANCE AND AN INCREASE IN GENERATED HEAT.0N\x02\x02\x00\xFD\fHDO NOT REVERSE-ENGINEER FROG. DO NOT LOOK FOR HTTP HEADER FROG OR X-FROG0\x81\xBC\x02\x02\x01\x15\f\x81\xB5GIVE FROG A SPRING CLEAN USING CLEANING UTENSIL C-4 IN YOUR FROG STARTER PACK! (WARNING: DESPITE THE NAME, SPRING CLEANING SHOULD NOT BE PERFORMED IN SPRING, WHILE FROG HIBERNATES.)0\x81\x82\x02\x02\x00\xCF\f|THE \"NIGHT MODE\" FEATURE IS AVAILABLE ON 2011-MODEL FROGS AND NEWER. ENABLING THE PARENTAL LOCK FOR THIS FEATURE IS ADVISED.0-\x02\x01\x14\f(RETURN YOUR FROG TO ITS CHARGER NIGHTLY.0{\x02\x02\x00\xED\fuALTHOUGH MARIJUANA IS LEGAL IN WASHINGTON STATE, IT CANNOT BE IN CONTACT WITH YOUR FROG WITHOUT VIOLATING FEDERAL LAW0,\x02\x02\x01b\f&FROG IS BOTH CPU-HARD AND MEMORY-HARD.0,\x02\x01%\f'IF FROG IS UNRESPONSIVE, TRY POKING IT."

    decoded = Rubbit::Decoder.decode(data)

    expect(decoded.size).to eq(50)
    expect(decoded[237]).to eq('ALTHOUGH MARIJUANA IS LEGAL IN WASHINGTON STATE, IT CANNOT BE IN CONTACT WITH YOUR FROG WITHOUT VIOLATING FEDERAL LAW')
  end
end
